classDiagram
  subgraph Systems
    class MessageSystem {
      -logger
      -manager
      +initialize()
      +setup_panel()
      +render()
      +log_message()
      +log_success()
      +log_warning()
      +log_critical()
      +get_recent_messages()
      +handle_input()
      +toggle_selection_mode()
      +selection_mode?()
      +cleanup()
    }
    class InventoryRenderSystem {
      -renderer
      -logger
      -message_system
      -currently_selected_item_index
      -item_action_mode
      +initialize()
      +render_inventory()
      +render_equipment_section()
      +select_item()
      +show_item_actions()
      +handle_input()
      +draw_text()
      +draw_panel_border()
      +get_item_color()
      +get_item_display_string()
      +show_item_details()
    }
    class InventorySystem {
      -logger
      -message_system
      +initialize()
      +add_item()
      +remove_item()
      +use_item()
      +equip_item()
      +unequip_item()
      +drop_item()
      +item_name()
      +use_consumable()
      +toggle_equip()
      +log_message()
    }
    class ItemInteractionSystem {
      -inventory_system
      -message_system
      +initialize()
      +process_items_at_location()
      +pickup_item()
      +pickup_all_items()
      +find_items_at_position()
    }
    class MonsterSystem {
      -grid
      -player
      -monsters
      -logger
      -rng
      +initialize()
      +spawn_monsters()
      +update()
      +monster_at()
      +player_collision?()
      +determine_monster_count()
      +spawn_monster()
      +find_spawn_location()
      +select_weighted_monster_type()
      +valid_move?()
    }
    class MovementSystem {
      -grid
      -logger
      +initialize()
      +move()
      +can_process?()
      +normalize_direction()
      +get_target_cell()
      +can_move_to?()
      +handle_special_cell_attributes()
      +update_position()
      +log_movement()
    }
    class RenderSystem {
      -renderer
      -logger
      +initialize()
      +clear_screen()
      +render()
    }
  end
  %% Relationships
  MovementSystem --> MovementSystem : uses
  MovementSystem --> MessageSystem : uses
